---
aip:
  id: 5300
  state: draft
  created: 2020-01-15
js:
  - /assets/js/graphviz/viz.js
  - /assets/js/graphviz/lite.render.js
  - /assets/js/aip/aip-graphviz.js
permalink: /5300
---

# Errors

When error conditions happen, it is very advisable to have a single error response format across all the organization to drive consistency of the managing of documentation, error handling client side, server side, the tracing and others. In addition, this lends us to centralized management of errors to allow for governing and sharing error “types” across api families.

Currently our various api families have their own *bespoke* standards, none of which appear suitable for achieving the above goals. As such, we are stipulating that error responses MUST follow the [RFC7807](https://tools.ietf.org/html/rfc7807) format. Also, the error responses SHOULD align with the general format of the API (e.g: *JSON)* and the format MAY be subject of content type negotiation.

While the RFC document remains an authoritative source of information, the rest of this section describe and extend the standard to a small extent.

The error message object MUST (as opposed to being optional in [RFC7807](https://tools.ietf.org/html/rfc7807)) include a `type` element. The URI used SHOULD be relative and use the `https` scheme (as opposed to MAY use `http` or `https`).

The error message object SHOULD NOT include a `status` element (as opposed to MAY) as it is deemed superfluous and redundant.

As a clarifying note, [RFC7807](https://tools.ietf.org/html/rfc7807) expects the `instance` element to contain an URI identifying the error instance, e.g: `myapi.com/errors/123`, this value should be useful for troubleshooting if the client application developer includes it in a support request. This could at the same time be a resolvable to a logging system or some other sort of system that can provide more information to the client. Caution should be applied to not to leak internal systems information to the API client.

The following listing is an example of an error message:

```
HTTP/1.1 403 Forbidden
Content-Type: application/problem+json
Content-Language: en

{
    "type": "https://example.com/probs/out-of-credit",
    "title": "You do not have enough credit.",
    "detail": "Your current balance is 30, but that costs 50.",
    "instance": "/account/12345/msgs/abc",
    "balance": 30,
    "accounts": ["/account/12345",
                 "/account/67890"]
}
```

## ADDITIONAL CONSIDERATIONS FOR FUTURE VERSIONS

* Standard metadata for errors (e.g. retriable)
* How to share error types
* Standards for reporting errors back from composite/bulk/batch apis
